<section class="mx-auto max-w-6xl px-4 py-10 space-y-6">
  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-bold text-slate-900 dark:text-slate-100">Feedback</h1>
    <div class="flex items-center gap-2">
      <a href="/admin/feedback?filter=open"
         class="px-3 py-1.5 rounded-lg border
                <%= filter==='open' ? 'bg-sky-600 text-white border-sky-600' : 'border-slate-300 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-800' %>">Öppna</a>
      <a href="/admin/feedback?filter=handled"
         class="px-3 py-1.5 rounded-lg border
                <%= filter==='handled' ? 'bg-sky-600 text-white border-sky-600' : 'border-slate-300 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-800' %>">Hanterade</a>
      <a href="/admin/feedback?filter=all"
         class="px-3 py-1.5 rounded-lg border
                <%= filter==='all' ? 'bg-sky-600 text-white border-sky-600' : 'border-slate-300 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-800' %>">Alla</a>
    </div>
  </div>

  <% if (!items || items.length === 0) { %>
    <div class="rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-6 text-slate-600 dark:text-slate-300">
      Inget att visa.
    </div>
  <% } else { %>
    <ul class="divide-y divide-slate-200 dark:divide-slate-800 border border-slate-200 dark:border-slate-800 rounded-xl bg-white dark:bg-slate-900 shadow-sm">
      <% items.forEach(function(it){ %>
        <li class="p-5">
          <div class="flex items-start justify-between gap-4">
            <div class="min-w-0">
              <div class="flex items-center gap-2 mb-1">
                <% const badge =
                  it.category==='bug' ? 'bg-red-100 text-red-700 border border-red-200 dark:bg-red-900/30 dark:text-red-200 dark:border-red-900/50' :
                  it.category==='suggestion' ? 'bg-amber-100 text-amber-700 border border-amber-200 dark:bg-amber-900/30 dark:text-amber-200 dark:border-amber-900/50' :
                  'bg-emerald-100 text-emerald-700 border border-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-200 dark:border-emerald-900/50';
                const label =
                  it.category==='bug' ? 'Problem' :
                  it.category==='suggestion' ? 'Förslag' : 'Önskemål';
                %>
                <span class="text-[10px] px-1.5 py-0.5 rounded <%= badge %>"><%= label %></span>

                <% if (!it.is_handled) { %>
                  <span class="text-[10px] px-1.5 py-0.5 rounded bg-sky-100 text-sky-700 border border-sky-200 dark:bg-sky-900/30 dark:text-sky-200 dark:border-sky-900/50">Ny</span>
                <% } %>
              </div>

              <div class="whitespace-pre-wrap text-slate-800 dark:text-slate-100"><%= it.message %></div>

              <div class="mt-2 text-xs text-slate-500 dark:text-slate-400">
                <%= it.user_name ? ('Från ' + it.user_name + (it.user_email ? ' <' + it.user_email + '>' : '')) : 'Från anonym användare' %>
                • <%= new Date(it.created_at).toLocaleString('sv-SE') %>
              </div>
            </div>

            <form method="POST" action="/admin/feedback/<%= it.id %>/toggle" class="shrink-0">
              <button class="inline-flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium
                             <%= it.is_handled ? 'bg-slate-100 text-slate-700 hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700' :
                                                 'bg-emerald-600 text-white hover:bg-emerald-700' %>">
                <i class="ti <%= it.is_handled ? 'ti-arrow-back-up' : 'ti-check' %>"></i>
                <%= it.is_handled ? 'Markera som öppen' : 'Markera som hanterad' %>
              </button>
            </form>
          </div>
        </li>
      <% }) %>
    </ul>
  <% } %>
</section>