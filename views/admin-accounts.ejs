<!-- views/admin-accounts.ejs -->
<section class="mx-auto max-w-6xl px-4 py-10 space-y-12">
  <h1 class="text-2xl font-bold text-slate-900">Alla konton & dealers</h1>

  <!-- Users -->
  <div>
    <h2 class="text-xl font-semibold text-slate-900 mb-4">Användare (users)</h2>
    <% if (!users || users.length === 0) { %>
      <div class="rounded-xl border border-slate-200 bg-white p-6 text-slate-600">
        Inga användare hittades.
      </div>
    <% } else { %>
      <div class="overflow-x-auto rounded-xl border border-slate-200 bg-white shadow-sm">
        <table class="min-w-full text-sm">
          <thead class="bg-slate-50 text-slate-700 text-left font-semibold">
            <tr>
              <th class="px-4 py-2">ID</th>
              <th class="px-4 py-2">Email</th>
              <th class="px-4 py-2">Namn</th>
              <th class="px-4 py-2">Roll</th>
              <th class="px-4 py-2">Skapad</th>
              <th class="px-4 py-2">Uppdaterad</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-slate-200">
            <% users.forEach(u => { %>
              <tr class="hover:bg-slate-50">
                <td class="px-4 py-2 font-mono text-xs text-slate-500"><%= u.id %></td>
                <td class="px-4 py-2"><%= u.email %></td>
                <td class="px-4 py-2"><%= u.name %></td>
                <td class="px-4 py-2">
                  <span class="inline-flex items-center px-2 py-0.5 rounded text-xs
                    <%= u.role === 'admin' ? 'bg-red-100 text-red-700' : 'bg-emerald-100 text-emerald-700' %>">
                    <%= u.role %>
                  </span>
                </td>
                <td class="px-4 py-2 text-slate-500"><%= new Date(u.created_at).toLocaleString('sv-SE') %></td>
                <td class="px-4 py-2 text-slate-500"><%= new Date(u.updated_at).toLocaleString('sv-SE') %></td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    <% } %>
  </div>

  <!-- Dealers -->
  <div>
    <h2 class="text-xl font-semibold text-slate-900 mb-4">Dealers (NMS & Dynex)</h2>
    <% if (!dealers || dealers.length === 0) { %>
      <div class="rounded-xl border border-slate-200 bg-white p-6 text-slate-600">
        Inga dealers hittades.
      </div>
    <% } else { %>
      <div class="overflow-x-auto rounded-xl border border-slate-200 bg-white shadow-sm">
        <table class="min-w-full text-sm">
          <thead class="bg-slate-50 text-slate-700 text-left font-semibold">
            <tr>
              <th class="px-4 py-2">Källa</th>
              <th class="px-4 py-2">Dealer ID</th>
              <th class="px-4 py-2">Email</th>
              <th class="px-4 py-2">Namn</th>
              <th class="px-4 py-2">Företag</th>
              <th class="px-4 py-2">Telefon</th>
              <th class="px-4 py-2">Tillagd</th>
              <th class="px-4 py-2">Senast synkad</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-slate-200">
            <% dealers.forEach(d => { %>
              <tr class="hover:bg-slate-50">
                <td class="px-4 py-2"><%= d.source %></td>
                <td class="px-4 py-2 font-mono text-xs text-slate-500"><%= d.dealer_id %></td>
                <td class="px-4 py-2"><%= d.email %></td>
                <td class="px-4 py-2"><%= [d.firstname, d.lastname].filter(Boolean).join(' ') || d.username %></td>
                <td class="px-4 py-2"><%= d.company %></td>
                <td class="px-4 py-2"><%= d.telephone || '-' %></td>
                <td class="px-4 py-2 text-slate-500"><%= d.added || '-' %></td>
                <td class="px-4 py-2 text-slate-500"><%= new Date(d.updated_at).toLocaleString('sv-SE') %></td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    <% } %>
  </div>
</section>